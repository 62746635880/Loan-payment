<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Transaction Confirmation</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
.fade-out { animation: fadeOut 3s forwards; }
@keyframes fadeOut { from {opacity:1;} to {opacity:0;} }
button:disabled, a:disabled { opacity:0.5; cursor:not-allowed; pointer-events:none; }
</style>
</head>
<body class="bg-gradient-to-r from-purple-50 to-indigo-50 min-h-screen flex flex-col items-center justify-center p-4">

<div id="confirmationContainer" class="max-w-md w-full bg-white rounded-3xl shadow-2xl p-8 border border-gray-200 text-center">

  <!-- Header with Countdown -->
  <div class="flex justify-between items-center mb-4 
              bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 
              p-4 rounded-2xl shadow-lg text-white">
    <h1 id="appName" class="text-3xl font-extrabold"></h1>
    <div class="text-white font-medium text-lg">Time Left: <span id="timer">09:00</span></div>
  </div>

  <div id="confirmationMessage" class="text-gray-700 text-lg font-semibold">
    <!-- Dynamic confirmation message -->
  </div>
</div>

<div id="expiredContainer" class="hidden w-full max-w-md bg-white rounded-3xl shadow-2xl p-8 border border-gray-200 text-center">
  <h1 class="text-3xl font-bold text-red-600 mb-4">Page Expired</h1>
  <p class="text-gray-700">Your payment session has timed out. Please generate a new link to complete the transaction.</p>
</div>

<script>
// Get parameters from URL
const params = new URLSearchParams(window.location.search);
const app = params.get('app') || 'Payment';
const client = params.get('pn') || 'Customer';
const amount = params.get('am') || '0';
const expiryParam = params.get('expiry');

document.getElementById('appName').innerText = decodeURIComponent(app);
document.getElementById('confirmationMessage').innerText = 
`Dear "${decodeURIComponent(client)}", your â‚¹${decodeURIComponent(amount)} transaction is Under Review. After confirmation, you will receive the NOC of loan closing.`;

// Countdown timer
const timerElement = document.getElementById('timer');
const expiryTime = expiryParam ? parseInt(expiryParam) : Date.now() + 9*60*1000;

const countdown = setInterval(() => {
  const now = Date.now();
  let remaining = Math.floor((expiryTime - now)/1000);
  if (remaining <= 0) {
    clearInterval(countdown);
    document.getElementById('confirmationContainer').classList.add('hidden');
    document.getElementById('expiredContainer').classList.remove('hidden');
    return;
  }
  const minutes = Math.floor(remaining/60);
  const seconds = remaining % 60;
  timerElement.textContent = `${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;
}, 1000);

// Prevent back navigation to payment page
history.pushState(null, document.title, location.href);
window.addEventListener('popstate', function () {
    history.pushState(null, document.title, location.href);
});
</script>
</body>
</html>
